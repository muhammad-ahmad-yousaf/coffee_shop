{% extends "base.html" %}
{% block title %}Your Cart{% endblock %}

{% block content %}
<h2>Your Cart</h2>
<ul>
    {% for item in cart %}
        <li>
            {{ item.item.name }} - Rs: {{ item.item.price }} x {{ item.quantity }}
            = Rs: {{ item.total_price }}
            <a href="{% url 'remove-from-cart' item.item.id %}">Remove</a>
        </li>
    {% empty %}
        <li>Your cart is empty.</li>
    {% endfor %}
</ul>

<p><strong>Total before discount:</strong> Rs: {{ cart.get_total_price }}</p>

{% if cart.get_discount %}
    <p><strong>Discount:</strong> {{ cart.get_discount.name }} -Rs: {{ cart.get_total_after_discount.1 |floatformat:2}}</p>
{% endif %}

<p><strong>Total after discount:</strong> 
{% with total=cart.get_total_after_discount %}
    Rs: {{ total.0 |floatformat:2}}
{% endwith %}
</p>

<h3>Available Discounts</h3>
<ul>
    {% for discount in discounts %}
        <li>
            {{ discount.name }} - {{ discount.description }}
            <a href="{% url 'apply-discount' discount.id %}">Apply</a>
        </li>
    {% empty %}
        <li>No discounts available.</li>
    {% endfor %}
</ul>

{% if cart.cart %}
    <a href="{% url 'place-order' %}">Place Order</a>
{% endif %}
{% endblock %}
